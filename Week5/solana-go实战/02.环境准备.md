# 环境准备指南

## 1. 工具链安装

### 1.1 安装 Solana CLI
```bash
# 使用官方脚本安装（默认安装稳定版）
sh -c "$(curl -sSfL https://release.solana.com/stable/install)"

# 验证安装成功
solana --version
# 预期输出：solana-cli 1.16.x (stable)

# 配置开发网络
solana config set --url devnet
```

### 1.2 安装 Go 绑定生成工具
```bash
# 安装 abigen 工具
go install github.com/portto/solana-go-sdk/abigen@latest

# 验证工具路径
which abigen
# 预期输出：$GOPATH/bin/abigen
```

## 2. 项目初始化

### 2.1 创建项目目录
```bash
mkdir solana-interactor && cd solana-interactor
```

### 2.2 初始化 Go 模块
```bash
go mod init solana-interactor

# 添加 SDK 依赖
go get github.com/portto/solana-go-sdk@v1.25.0

# 同步依赖
go mod tidy
```

## 3. 环境验证

### 3.1 创建测试文件
```go:main.go
package main

import (
	"github.com/portto/solana-go-sdk/client"
	"github.com/portto/solana-go-sdk/rpc"
)

func main() {
	c := client.NewClient(rpc.DevnetRPCEndpoint)
	version, _ := c.GetVersion(context.Background())
	println("Solana node version:", version.SolanaCore)
}
```

### 3.2 运行验证程序
```bash
go run main.go
# 预期输出：Solana node version: 1.16.x
```

## 常见问题排查
1. **Solana CLI 安装失败**  
   ```bash
   # 手动设置安装版本
   export SOLANA_RELEASE=stable && curl -sSfL https://release.solana.com/$SOLANA_RELEASE/install | sh
   ```

2. **abigen 命令未找到**  
   ```bash
   # 将 GOPATH/bin 添加到 PATH
   export PATH=$PATH:$(go env GOPATH)/bin
   ```

3. **依赖下载超时**  
   ```bash
   # 设置 GOPROXY
   go env -w GOPROXY=https://goproxy.cn,direct
   ```



在 Solana 开发中，RPC 端点的使用方式与以太坊有所不同。根据您的需求，这里补充说明如何配置 RPC 连接：

```markdown:/Users/zhujie/workspace/base2/lecture/backend/upgrade/solana-go实战/02.环境准备.md
## 4. RPC 配置（可选增强）

### 4.1 使用公共端点（开发推荐）
```go
// 直接使用 Solana 官方节点
c := client.NewClient(rpc.DevnetRPCEndpoint) // 等同 https://api.devnet.solana.com
```

### 4.2 使用增强服务（生产推荐）
1. 注册 Alchemy 账号并创建 Solana 应用
2. 获取专属 RPC URL（包含API Key）
```go
// 替换为 Alchemy 的专属端点
c := client.NewClient("https://solana-devnet.g.alchemy.com/v2/YOUR_API_KEY")
```

### 4.3 速率限制说明
| 服务类型       | 免费版 QPS | 适用场景         |
|----------------|------------|------------------|
| 官方公共节点   | 10-20      | 开发测试         |
| Alchemy        | 100+       | 生产环境         |
```

```go
// ... existing code ...
func main() {
    // 生产环境替换为
    c := client.NewClient("https://solana-mainnet.g.alchemy.com/v2/YOUR_API_KEY")
    // 开发环境保持
    // c := client.NewClient(rpc.DevnetRPCEndpoint)
}
```

关键建议：
1. 开发阶段使用官方节点足够（已自动包含在SDK中）
2. 需要高可靠性时注册 Alchemy（免费套餐含 300M CU/月）
3. 永远不要将API Key提交到Git仓库（使用环境变量）